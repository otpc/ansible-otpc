---
- name: Load the configuration to Junos devices
  hosts: spines.dev
  roles:
  - Junos
  connection: local
  gather_facts: no
  vars_prompt:
    - name: user
      prompt: "Username"
    - name: passwd
      prompt: "Password"

  tasks: 

  - name: Building leafs main configuration
    template:
      src: junos.set.j2
      dest: "/etc/ansible/config_jinja/{{ inventory_hostname }}/junos.set"

  - name: Load the configuration file
    install_junos: 
      host={{ inventory_hostname }}
      file=/etc/ansible/config_jinja/{{ inventory_hostname }}/junos.set
      port=22
      user={{ user }}
      passwd={{ passwd }}
